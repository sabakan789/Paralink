<div class="wrapper">
  <div class="container add-color default-container">
    <div class="row">
      <div class="col-md-offset-2 col-md-8 col-sm-offset-1 col-sm-10 col-xs-offset-1 col-xs-10 micropost-conteiner micropost-show">
        <h2 class="micropost-user-name"><%= link_to @micropost.user.name ,user_path(@micropost.user), :style=>"color:white;"%></h2>
        <p class="micropost-content"><%= @micropost.content %></p>
        <% if @micropost.user == current_user %>
          <%= link_to micropost_path(micropost_id: @micropost.id), method: :delete, data: {confirm: "この投稿を本当に削除しますか？"},class:'pull-right' do %>
            <i class="fas fa-trash" aria-hidden="true"></i>
          <% end %>
        <% end %>
        <% if @micropost.user == current_user %>
          <% if @micropost.topics.count == 4 %>
            <% @micropost.topics.each do |topic| %>
              <%= image_tag topic.image.url , alt:'topic.description',class: "img-responsive center-block"%>
              <%= link_to "画像を削除", micropost_topic_path(@micropost.id, topic.id) , method: :delete, data: {confirm: "本当に削除しますか？"}, class: "delete-btn pull-right"%>
            <% end %>
          <% elsif @micropost.topics.count <= 3 && @micropost.topics.count > 0 %>
            <% @micropost.topics.each do |topic| %>
              <%= image_tag topic.image.url , alt:'topic.description',class: "img-responsive center-block" %>
              <%= link_to "画像を削除", micropost_topic_path(@micropost.id, topic.id) , method: :delete, data: {confirm: "本当に削除しますか？"},class: "delete-btn pull-right"%>
            <% end %>
            <%= link_to "画像を追加する", new_micropost_topic_path(micropost_id: @micropost.id), class: "btn-white btn" %>
          <% else %>
            <%= link_to "画像を追加する", new_micropost_topic_path(micropost_id: @micropost.id), class: "btn-white btn" %>
          <% end %>
            <div class="row comment-box">
              <h2 class="text-center">コメント一覧</h2>
              <%=link_to "コメントする", comments_path(micropost_id: @micropost.id), class: "btn btn-comment pull-right" %>
            </div>
          <% @micropost.comments.each do |comment| %>
            <h3><%= link_to comment.user.name, user_path(comment.user), :style=>"color:white;" %></h3>
            <p class="comment-text"><%= comment.comment %></p>
            <% if comment.user == current_user %>
              <%= link_to "コメントを削除", comments_destroy_path(micropost_id: @micropost.id, comment_id: comment.id), method: :delete, data: {confirm: "本当に削除しますか？" }, class: "btn delete-btn pull-right" %>
            <% end %>
          <% end %>
        <% else %>
          <% @micropost.topics.each do |topic| %>
            <%= image_tag topic.image.url , alt:'topic.description',class: "img-responsive center-block"%>
          <% end %>
          <div class="col-md-2 col-sm-3 col-xs-4">
            <% if !@micropost.favorite_users.include?(current_user) %>
              <%= link_to favorites_path(micropost_id: @micropost.id), method: :post do %>
                <i class="far fa-heart" aria-hidden="true"></i>
              <% end %>
            <% else %>
              <%= link_to favorites_path(micropost_id: @micropost.id), method: :delete do %>
                <i class="fa fa-heart" aria-hidden="true"></i>
              <% end %>
            <% end %>
            <%= @micropost.favorite_users.count %>
          </div>
          <% if @micropost.user.followed_by?(current_user) %>
            <%=link_to "フォロー済み", user_relationships_path(@micropost.user.id), method: :delete , class: 'btn btn-following col-md-3 col-sm-4 col-xs-5'%>
          <% else %>
            <%=link_to "フォローする", user_relationships_path(@micropost.user.id), method: :post , class: 'btn btn-follow col-md-3 col-sm-4 col-xs-5'%>
          <% end %>
          <div class="row comment-box">
            <h2 class="text-center">コメント一覧</h2>
            <%=link_to "コメントする", comments_path(micropost_id: @micropost.id), class: "btn btn-comment pull-right" %>
          </div>
          <% @micropost.comments.each do |comment| %>
            <h3><%= link_to comment.user.name, user_path(comment.user), :style=>"color:white;" %></h3>
            <p class="comment-text"><%= comment.comment %></p>
            <% if comment.user == current_user %>
              <%= link_to "コメントを削除", comments_destroy_path(micropost_id: @micropost.id, comment_id: comment.id), method: :delete, data: {confirm: "本当に削除しますか？" }, class: "btn delete-btn pull-right" %>
            <% end %>
          <% end %>
        <% end %>
      </div>
    </div>
  </div>
</div>
